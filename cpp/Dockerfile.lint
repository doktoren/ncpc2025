FROM ubuntu:22.04

RUN apt-get update -qq && \
    apt-get install -qq -y \
    clang-format \
    cppcheck \
    && rm -rf /var/lib/apt/lists/*

# Use build args for user/group ID (defaults to 1000 if not specified)
ARG USER_ID=1000
ARG GROUP_ID=1000

# Create user with matching UID/GID to avoid permission issues
RUN groupadd -g ${GROUP_ID} user && \
    useradd -u ${USER_ID} -g ${GROUP_ID} -m -s /bin/bash user

USER user
WORKDIR /workspace

CMD ["./lint.sh"]
